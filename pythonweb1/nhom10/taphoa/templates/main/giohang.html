{% extends 'main/base.html' %} 
{% load static %}

{% block title %}Giỏ hàng{% endblock %}

{% block linkcss %}
<link rel="stylesheet" href="{% static 'css/giohang.css' %}">
<link rel="stylesheet" href="{% static 'css/giohang1.css' %}">
{% endblock %}

{% block secondnav %}{% endblock %}

{% block sanpham %}
<div class="giohang">
    <h1 class="text-center">Giỏ hàng</h1>

    <div class="box-element">
        <div class="cart-row">
            <div style="flex:1"></div>
            <div style="flex:2"><strong>Sản phẩm</strong></div>
            <div style="flex:1"><strong>Số lượng</strong></div>
            <div style="flex:1"><strong>Đơn giá</strong></div>
        </div>

        {% for item in items %}
        <div class="cart-row">
            <div style="flex:1">
                <img class="row-image" src="/media/{{ item.product.image }}">
            </div>
            <div style="flex:2">
                <strong>{{ item.product.product_name }}</strong>
            </div>
            <div style="flex:1">
                <div class="quantity">
                    <i class="fa-solid fa-square-minus update-cart" data-product="{{ item.product.id }}" data-action="remove"></i>
                    <p class="quantity-number">{{ item.quantity }}</p>
                    <i class="fa-solid fa-square-plus update-cart" data-product="{{ item.product.id }}" data-action="add"></i>
                </div>
            </div>
            <p class="item-total-price" data-product-id="{{ item.product.id }}">{{ item.get_total }}₫</p>

        </div>
        {% endfor %}

        <div class="cart-row mt-3">
            <div style="flex:3; text-align: right;"><strong>TỔNG:</strong></div>
            <div style="flex:1"><strong>{{ order.get_cart_items }}</strong></div>
            <div style="flex:1"><strong>{{ order.get_cart_total }}₫</strong></div>
        </div>
    </div>

    <div class="d-grid gap-2 col-5 ms-auto mt-4 text-end">
        {% if user.is_authenticated %}
            <a class="btn btn-success" href="{% url 'thongtinmuahang' %}">Thanh toán</a>
        {% else %}
            <button class="btn btn-danger" disabled>Vui lòng đăng nhập để thanh toán</button>
            <p class="mt-2">
                <a href="{% url 'login' %}?next={{ request.path }}">Đăng nhập ngay</a> để tiếp tục thanh toán.
            </p>
        {% endif %}
    </div>
</div>
{% endblock %}
